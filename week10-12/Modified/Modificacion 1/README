This code was tested in Linux
